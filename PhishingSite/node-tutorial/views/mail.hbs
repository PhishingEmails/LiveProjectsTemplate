<h2>Inbox</h2>
<SCRIPT SRC="views\mail.js"></SCRIPT>
<table class="table">
  <thead class="thead-light">
    <th scope="col">From</th>
    <th scope="col">Subject</th>
    <th scope="col">Received</th>
    <th></th>
    <!--<th scope="col">ID</th>-->
    <th scope="col"></th>
  </thead>
  <tbody>
    {{#each messages}}
      <tr class="{{#unless this.isRead}}table-primary{{/unless}}">
        <td title="{{this.from.emailAddress.address}}">{{this.from.emailAddress.name}}</td>
        <td>{{this.subject}}</td>
        <td>{{this.receivedDateTime}}</td>
        <!--<td>{{this.id}}</td>-->
        <td><button type="button" class="btn btn-success" onclick="\routes\mail({{this.id}});"href = '\routes\mail'>View Email</button></td>
        {{!-- <td><button method = "post" id = "postbutton" type="button" class="btn btn-danger" onclick="forward();">Report</button></td> --}}
        <td><button method = "post" id = "postbutton" type="button" class="btn btn-danger" data-toggle="modal" data-target="#myModal" data-backdrop="false"">Report</button></td>
      </tr>
    {{/each}}
  </tbody>
</table>


<!-- Modal -->
<div id="myModal" class="modal fade" role="dialog">
  <div class="modal-dialog modal-lg">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">Phishing Report</h4>
      </div>
      <div class="modal-body">
        <p>Thank You For Submitting a Phishing Report. We Will Contact You When We Have Investigated This.
          </br> Reference Number : 20168
        </p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>

  </div>
</div>



{{!-- <script>const button = document.getElementById('postbutton');
button.addEventListener('click', async _ => {
  try {     
    const response = await fetch('https://graph.microsoft.com/v1.0/me/messages/'+{id}+'/forward', {
      method: 'POST',
      headers: { "content-type" : "application/json" ,  "authorization" : graph_access_token}
      body: JSON {
        "Comment": "REPORT",
        "ToRecipients": [
             {"EmailAddress": {
             "Address": "phishingreport@outlook.com"}}]
            });
      }
    console.log('Completed!', response);
  } catch(err) {
    console.error(`Error: ${err}`);
  }
});
</script> --}}
